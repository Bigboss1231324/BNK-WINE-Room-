<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BNK Wine Room - Thailand's Premier Wine Importer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #0a0a0a;
            color: #f3f3f3;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }
        .font-playfair { font-family: 'Playfair Display', serif; }
        .bg-deep-red { background-color: #800000; }
        .text-gold { color: #c4a57f; }
        .border-gold { border-color: #c4a57f; }
        .btn-primary { @apply bg-deep-red text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:bg-red-800 transition-all duration-300 ease-in-out transform; }
        .btn-secondary { @apply border-2 border-gold text-gold font-semibold py-3 px-8 rounded-lg hover:bg-gold hover:text-black transition-all duration-300 ease-in-out; }
        .cart-badge { @apply absolute -top-2 -right-2 bg-gold text-black text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center; }

        #hero-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background: radial-gradient(ellipse at bottom, #3a0000 0%, #000000 70%);
        }
        .hero-content {
            position: relative;
            z-index: 2;
        }
        .hero-title { letter-spacing: 0.05em; }
        .scroll-arrow { animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-20px); } 60% { transform: translateY(-10px); } }

        .wine-card {
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            @apply rounded-xl overflow-hidden shadow-lg transition-all duration-500 ease-in-out transform flex flex-col border-2 border-transparent;
        }
        .wine-card:hover {
            transform: scale(1.03) translateY(-5px);
            box-shadow: 0 0 30px rgba(196, 165, 127, 0.3);
            border-color: rgba(196, 165, 127, 0.5);
        }
        .wine-card .image-container { @apply relative h-96 overflow-hidden; }
        .wine-card img { transition: transform 0.5s ease-in-out; }
        .wine-card:hover img { transform: scale(1.1); }
        .wine-card .btn-primary { transition: transform 0.4s ease-in-out; }
        .wine-card:hover .btn-primary { transform: scale(1.1); }
        .wine-card .card-content { @apply p-6 flex flex-col flex-grow; }

        #toast-notification { transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out; transform: translateY(100%); opacity: 0; }
        #toast-notification.show { transform: translateY(0); opacity: 1; }
        .animate-on-scroll { opacity: 0; transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .animate-fade-in-up { transform: translateY(30px); }
        .animate-fade-in-left { transform: translateX(-30px); }
        .animate-on-scroll.is-visible { opacity: 1; transform: translate(0, 0); }

        .dropdown .dropdown-menu { display: none; }
        .dropdown:hover .dropdown-menu { display: block; }

        .line-float {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 70px;
            height: 70px;
            z-index: 1000;
            cursor: pointer;
            border-radius: 1rem;
            transition: transform 0.3s ease-in-out;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .line-float:hover {
            transform: scale(1.1);
        }

        /* Modal specific styles */
        .modal {
            @apply fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 transition-opacity duration-300 ease-in-out opacity-0 pointer-events-none;
        }
        .modal.show {
            @apply opacity-100 pointer-events-auto;
        }
        .modal-content {
            @apply bg-[#111111] border-2 border-gold rounded-lg p-8 max-w-lg w-11/12 transform scale-95 transition-transform duration-300 ease-in-out;
        }
        .modal.show .modal-content {
            @apply scale-100;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-50 backdrop-blur-md">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="text-2xl font-playfair font-bold text-white">BNK Wine Room</div>
                <nav class="hidden md:flex items-center space-x-8">
                    <div class="relative dropdown">
                        <button class="text-gray-300 hover:text-white transition inline-flex items-center py-2">
                            Catalog
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="dropdown-menu absolute hidden bg-black bg-opacity-80 backdrop-blur-md rounded-md shadow-lg top-full w-48 py-2 z-20">
                            <a href="old-world.html" class="block px-4 py-2 text-sm text-gray-300 hover:bg-deep-red hover:text-white">Old World</a>
                            <a href="new-world.html" class="block px-4 py-2 text-sm text-gray-300 hover:bg-deep-red hover:text-white">New World</a>
                        </div>
                    </div>
                    <a href="#about" class="text-gray-300 hover:text-white transition">Our Story</a>
                </nav>
                <div class="flex items-center space-x-4">
                    <!-- Removed login link -->
                    <a href="cart.html" class="text-gray-300 hover:text-white transition relative" aria-label="Shopping Cart"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4z" /></svg><span id="cart-item-count" class="cart-badge hidden">0</span></a>
                </div>
            </div>
        </div>
    </header>

    <!-- 3D Hero Section -->
    <section class="h-screen relative flex flex-col items-center justify-center text-center text-white p-4">
        <canvas id="hero-canvas"></canvas>
        <div class="hero-content">
            <div class="bg-black bg-opacity-60 p-10 rounded-lg">
                <h1 class="text-5xl md:text-7xl font-playfair font-bold leading-tight hero-title">A Curated World of Fine Wine.</h1>
                <p class="text-xl md:text-2xl font-light text-gold mt-4">Exclusively Imported for the Thai Connoisseur.</p>
            </div>
        </div>
        <div class="absolute bottom-10 scroll-arrow z-10">
            <svg class="w-8 h-8 text-white" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
        </div>
    </section>

    <!-- New World Wines Section -->
    <section id="new-world" class="py-24 bg-black">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-playfair font-bold text-white animate-on-scroll animate-fade-in-up">New World Selections</h2>
                <p class="text-lg text-gray-400 mt-2 animate-on-scroll animate-fade-in-up" style="transition-delay: 100ms;">Bold expressions from California, Australia, and Chile.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 200ms;">
                    <div class="image-container"><img src="https://i.ibb.co/L5BKn3w/octopoda.png" alt="Octopoda California Cabernet Sauvignon" class="w-full h-full object-contain p-4"></div>
                    <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">Octopoda Cabernet</h3>
                        <p class="text-gold mt-1 text-sm">California, USA</p>
                        <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-1">Full-bodied with bold fruit, balanced tannins, and a long finish.</p>
                            <p class="text-gray-500">ฟูลบอดี้พร้อมผลไม้เด่นชัด แทนนินสมดุล และจบยาว</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>14.5% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿1,990.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 1, name: 'Octopoda Cabernet Sauvignon', price: 1990, image: 'https://i.ibb.co/L5BKn3w/octopoda.png'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('Octopoda Cabernet', document.getElementById('desc-1').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
                <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 300ms;">
                    <div class="image-container"><img src="https://placehold.co/600x800/1a1a1a/ffffff?text=St.+John+Shiraz" alt="St. John Crush Shiraz" class="w-full h-full object-contain p-4"></div>
                     <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">St. John Crush Shiraz</h3>
                        <p class="text-gold mt-1 text-sm">Australia</p>
                        <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-15">Aroma: Black cherry, licorice, and dark fruit with spicy chocolate. Palate: Deep, rich tannins.</p>
                            <p class="text-gray-500">กลิ่นแบล็คเชอร์รี่ ชะเอมเทศ และผลไม้สีเข้มพร้อมช็อกโกแลตเผ็ดร้อน แทนนินเข้มข้น</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>15% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿1,290.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 15, name: 'St. John Crush Shiraz', price: 1290, image: 'https://placehold.co/600x800/1a1a1a/ffffff?text=St.+John+Shiraz'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('St. John Crush Shiraz', document.getElementById('desc-15').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
                <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 400ms;">
                    <div class="image-container"><img src="https://placehold.co/600x800/1a1a1a/ffffff?text=Amparo+Gran+Reserva" alt="Amparo Carménère Gran Reserva" class="w-full h-full object-contain p-4"></div>
                    <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">Amparo Gran Reserva</h3>
                        <p class="text-gold mt-1 text-sm">Chile</p>
                        <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-28">Palate: Full body, great concentration, with velvety tannins, balanced acidity, and lovely blueberries.</p>
                            <p class="text-gray-500">ฟูลบอดี้ เข้มข้นสูง แทนนินนุ่มนวล ความเป็นกรดสมดุล และบลูเบอร์รี่น่ารัก</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>13.5% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿1,590.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 28, name: 'Amparo Carménère Gran Reserva', price: 1590, image: 'https://placehold.co/600x800/1a1a1a/ffffff?text=Amparo+Gran+Reserva'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('Amparo Gran Reserva', document.getElementById('desc-28').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-16 animate-on-scroll animate-fade-in-up"><a href="new-world.html" class="btn-secondary">Explore New World Wines</a></div>
        </div>
    </section>

    <!-- Old World Wines Section -->
    <section id="old-world" class="py-24 bg-[#111111]">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-playfair font-bold text-white animate-on-scroll animate-fade-in-up">Old World Classics</h2>
                <p class="text-lg text-gray-400 mt-2 animate-on-scroll animate-fade-in-up" style="transition-delay: 100ms;">Timeless elegance from the historic vineyards of France.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                 <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 200ms;">
                    <div class="image-container"><img src="https://placehold.co/600x800/1a1a1a/ffffff?text=Chateau+de+Roques" alt="Chateau de Roques" class="w-full h-full object-contain p-4"></div>
                    <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">Chateau de Roques</h3>
                        <p class="text-gold mt-1 text-sm">France</p>
                        <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-6">Elegant structure, soft tannins, and great aging potential.</p>
                            <p class="text-gray-500">โครงสร้างหรูหรา แทนนินนุ่มนวล มีศักยภาพในการเก็บได้นาน</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>14.5% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿3,390.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 6, name: 'Chateau de Roques', price: 3390, image: 'https://placehold.co/600x800/1a1a1a/ffffff?text=Chateau+de+Roques'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('Chateau de Roques', document.getElementById('desc-6').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
                <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 300ms;">
                    <div class="image-container"><img src="https://placehold.co/600x800/1a1a1a/ffffff?text=Château+Valade" alt="Château Valade" class="w-full h-full object-contain p-4"></div>
                    <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">Château Valade</h3>
                        <p class="text-gold mt-1 text-sm">France</p>
                         <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-8">Beautiful ruby color with aromas of red fruits. Supple and fruity with fine tannins.</p>
                            <p class="text-gray-500">สีทับทิมสวยงามพร้อมกลิ่นหอมของผลไม้สีแดง เนื้อนุ่มและผลไม้พร้อมแทนนินละเอียด</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>13% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿1,690.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 8, name: 'Château Valade', price: 1690, image: 'https://placehold.co/600x800/1a1a1a/ffffff?text=Château+Valade'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('Château Valade', document.getElementById('desc-8').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
                <div class="wine-card animate-on-scroll animate-fade-in-up" style="transition-delay: 400ms;">
                    <div class="image-container"><img src="https://placehold.co/600x800/1a1a1a/ffffff?text=Chateau+Jean+De+Gue" alt="Chateau Jean De Gue" class="w-full h-full object-contain p-4"></div>
                    <div class="card-content">
                        <h3 class="text-xl font-playfair font-bold text-white">Chateau Jean De Gue</h3>
                        <p class="text-gold mt-1 text-sm">France</p>
                        <div class="mt-4 text-sm text-gray-400 space-y-2 flex-grow">
                            <p id="desc-12">Aromas of cedar, cassis, and tobacco dust. Full-bodied with a long and aromatic finish.</p>
                            <p class="text-gray-500">กลิ่นหอมของซีดาร์ แคสซิส และฝุ่นยาสูบ ฟูลบอดี้พร้อมรสชาติที่ยาวนานและหอม</p>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gold mt-4 pt-4 border-t border-gray-800">
                            <span>75cls</span>
                            <span>13% ABV</span>
                        </div>
                        <div class="flex justify-between items-center mt-4 space-x-2">
                            <p class="text-xl font-bold text-white">฿3,590.00</p>
                            <button class="btn-primary py-2 px-4 text-sm" onclick="addToCart({id: 12, name: 'Chateau Jean De Gue', price: 3590, image: 'https://placehold.co/600x800/1a1a1a/ffffff?text=Chateau+Jean+De+Gue'})">Add to Cart</button>
                            <button class="btn-secondary py-2 px-4 text-sm text-white bg-[#1a1a1a] border-2 border-transparent hover:bg-black" onclick="showFoodPairing('Chateau Jean De Gue', document.getElementById('desc-12').innerText)">✨ Pairing</button>
                        </div>
                    </div>
                </div>
            </div>
             <div class="text-center mt-16 animate-on-scroll animate-fade-in-up"><a href="old-world.html" class="btn-secondary">Explore Old World Wines</a></div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-24 bg-black">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-2 gap-16 items-center">
                <div class="animate-on-scroll animate-fade-in-left">
                    <h2 class="text-4xl font-playfair font-bold text-white mb-4">A Legacy of Passion.</h2>
                    <p class="text-gray-400 mb-6">"My family has been in the wine business for decades, building our company, B.N.K. PATTAYA WINE GALLERY CO.,LTD., on a foundation of trust and quality. As the second generation, my passion—my mission—is to build upon that legacy. My name is Bigboss, and BNK Wine Room is my personal curation of the world's most exceptional and exclusive wines, brought here for you."</p>
                    <p class="text-gray-400 mb-6">We are more than a store; we are a gallery. Each bottle is selected by me, and as a fully licensed importer, we guarantee its authenticity. This is the next chapter of our family's story.</p>
                </div>
                <div class="animate-on-scroll animate-fade-in-right" style="transition-delay: 200ms;"><img src="https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&q=80&w=1974" alt="Bigboss, Owner of BNK Wine Room" class="rounded-lg shadow-2xl"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact" class="bg-black py-12 border-t border-gray-800">
        <div class="container mx-auto px-6 text-center text-gray-500">
            <h3 class="text-2xl font-playfair text-white mb-2">BNK Wine Room</h3>
            <p>A presentation of B.N.K. PATTAYA WINE GALLERY CO.,LTD.</p>
            <p class="mt-4">Na Chom Thian, Chon Buri, Thailand</p>
            <div class="mt-8 text-sm">
                <p>&copy; 2025 B.N.K. PATTAYA WINE GALLERY CO.,LTD. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Floating LINE Icon -->
    <a href="https://lin.ee/KL279Ga" target="_blank" aria-label="Contact us on LINE" class="line-float">
        <img src="https://upload.wikimedia.org/wikipedia/commons/f/fd/LINE_logo_square.png" alt="LINE Official Account" class="w-full h-full rounded-2xl">
    </a>

    <!-- Toast Notification -->
    <div id="toast-notification" class="fixed bottom-5 right-5 bg-gold text-black p-4 rounded-lg shadow-lg max-w-sm z-50">
        <p id="toast-message" class="font-semibold"></p>
    </div>

    <!-- Pairing Suggestion Modal -->
    <div id="pairing-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center border-b border-gray-700 pb-4 mb-4">
                <h3 class="text-2xl font-playfair text-white" id="modal-title"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-white transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <p id="modal-text" class="text-gray-400 mb-4"></p>
            <p id="modal-loading" class="text-gold text-center hidden">Generating pairing...</p>
        </div>
    </div>


    <script>
        // --- 3D HERO SCENE: FERMENTATION ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const canvas = document.getElementById('hero-canvas');
        const renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });

        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.position.z = 5;

        const particleCount = 7000;
        const positions = new Float32Array(particleCount * 3);
        const velocities = new Float32Array(particleCount * 3);

        for(let i = 0; i < particleCount; i++) {
            positions[i * 3 + 0] = (Math.random() - 0.5) * 20;
            positions[i * 3 + 1] = (Math.random() - 0.5) * 10;
            positions[i * 3 + 2] = (Math.random() - 0.5) * 10;
            velocities[i * 3 + 1] = Math.random() * 0.005 + 0.001;
        }

        const particleGeometry = new THREE.BufferGeometry();
        particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

        const createParticleSystem = (color, size) => {
            const material = new THREE.PointsMaterial({ color: color, size: size, blending: THREE.AdditiveBlending, transparent: true, opacity: 0.7 });
            return new THREE.Points(particleGeometry, material);
        };

        const goldParticles = createParticleSystem(0xc4a57f, 0.02);
        const redParticles = createParticleSystem(0x800000, 0.03);
        scene.add(goldParticles);
        scene.add(redParticles);

        let mouse = new THREE.Vector2(-100, -100);
        document.addEventListener('mousemove', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
        });

        function animate() {
            requestAnimationFrame(animate);
            const positions = particleGeometry.attributes.position.array;
            for(let i = 0; i < particleCount; i++) {
                positions[i * 3 + 1] += velocities[i * 3 + 1];
                let dx = mouse.x * 5 - positions[i * 3 + 0];
                let dy = mouse.y * 5 - positions[i * 3 + 1];
                let distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < 1.5) {
                    let force = (1.5 - distance) * 0.001;
                    positions[i * 3 + 0] += dx * force;
                    positions[i * 3 + 1] += dy * force;
                }
                if (positions[i * 3 + 1] > 5) {
                    positions[i * 3 + 1] = -5;
                }
            }
            particleGeometry.attributes.position.needsUpdate = true;
            renderer.render(scene, camera);
        }
        window.onload = function () {
            animate();
        };

        window.addEventListener('resize', () => {
            renderer.setSize(window.innerWidth, window.innerHeight);
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
        });

        // --- GEMINI API INTEGRATION FOR FOOD PAIRING ---
        async function getFoodPairing(wineName, wineDescription, retries = 3, delay = 1000) {
            const prompt = `You are a sommelier. Provide a concise food pairing suggestion for the following wine. The response should be a single paragraph, and should include both English and a Thai translation.
            
            Wine Name: ${wineName}
            Wine Description: ${wineDescription}
            
            Format your response like this:
            [English pairing suggestion]. [Thai pairing suggestion].`;

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{
                    role: "user",
                    parts: [{ text: prompt }]
                }]
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    throw new Error("Invalid API response format.");
                }
            } catch (error) {
                if (retries > 0) {
                    console.error(`Attempt failed. Retrying in ${delay / 1000}s...`, error);
                    await new Promise(res => setTimeout(res, delay));
                    return getFoodPairing(wineName, wineDescription, retries - 1, delay * 2);
                } else {
                    console.error("All retry attempts failed.");
                    return "Could not generate a pairing suggestion. Please try again later. ไม่สามารถสร้างคำแนะนำการจับคู่ได้ โปรดลองอีกครั้งในภายหลัง";
                }
            }
        }

        async function showFoodPairing(wineName, wineDescription) {
            const modal = document.getElementById('pairing-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalText = document.getElementById('modal-text');
            const modalLoading = document.getElementById('modal-loading');

            modalTitle.innerText = `Pairing for ${wineName}`;
            modalText.innerText = '';
            modalLoading.classList.remove('hidden');
            modal.classList.add('show');

            try {
                const pairingText = await getFoodPairing(wineName, wineDescription);
                modalText.innerText = pairingText;
            } catch (error) {
                console.error("Error fetching food pairing:", error);
                modalText.innerText = "An error occurred. Please try again. เกิดข้อผิดพลาด. กรุณาลองใหม่อีกครั้ง";
            } finally {
                modalLoading.classList.add('hidden');
            }
        }

        function closeModal() {
            const modal = document.getElementById('pairing-modal');
            modal.classList.remove('show');
        }

        // --- CART LOGIC ---
        function addToCart(product) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const existingItemIndex = cart.findIndex(item => item.id === product.id);
            if (existingItemIndex > -1) {
                cart[existingItemIndex].quantity += 1;
            } else {
                product.quantity = 1;
                cart.push(product);
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            showToast(`${product.name} has been added to your cart.`);
        }

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
            const countElement = document.getElementById('cart-item-count');
            if (cartCount > 0) {
                countElement.textContent = cartCount;
                countElement.classList.remove('hidden');
            } else {
                countElement.classList.add('hidden');
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast-notification');
            const toastMessage = document.getElementById('toast-message');
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        // --- SCROLL ANIMATION LOGIC ---
        const animatedElements = document.querySelectorAll('.animate-on-scroll');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        animatedElements.forEach(el => { observer.observe(el); });

        // --- INITIAL PAGE LOAD LOGIC ---
        document.addEventListener('DOMContentLoaded', updateCartCount);
    </script>

</body>
</html>
